<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Gerenciador de Packs - Ch√° de Beb√™</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
<style>
    :root {
        --azul-fundo: #E6F3FA;
        --azul-primario: #5DADE2;
        --azul-claro: #D6EAF8;
        --branco: #FFFFFF;
    }

    body {
        margin: 0;
        padding: 20px;
        background-color: var(--azul-fundo);
        font-family: 'Nunito', sans-serif;
    }

    .folha-a4 {
        background-color: var(--branco);
        max-width: 900px;
        margin: 0 auto;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        position: relative;
    }

    header {
        text-align: center;
        margin-bottom: 30px;
        border-bottom: 3px dotted var(--azul-claro);
        padding-bottom: 15px;
    }

    h1 { font-family: 'Fredoka', sans-serif; color: var(--azul-primario); margin: 0; }

    .lista-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 15px;
    }

    .pack-item {
        background-color: #fcfdfe;
        border: 2px solid var(--azul-claro);
        border-radius: 12px;
        padding: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
    }

    .pack-item:hover {
        transform: translateY(-3px);
        border-color: var(--azul-primario);
        background-color: #fff;
    }

    /* Estilo para Pack Reservado */
    .pack-item.reservado {
        background-color: #D4EFDF;
        border-color: #52BE80;
    }

    .numero-circulo {
        background-color: var(--azul-primario);
        color: white;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-bottom: 10px;
    }

    .reservado .numero-circulo { background-color: #27AE60; }

    .produto { font-size: 13px; color: #444; margin-bottom: 3px; }
    .produto::before { content: "üß∏"; margin-right: 5px; font-size: 10px; }

    .info-reserva {
        margin-top: 10px;
        padding-top: 8px;
        border-top: 1px solid #eee;
        font-size: 12px;
        color: #27AE60;
        font-weight: bold;
    }

    /* Modal (Caixa de Di√°logo) */
    .modal-overlay {
        display: none;
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 100;
        justify-content: center;
        align-items: center;
    }

    .modal {
        background: white;
        padding: 25px;
        border-radius: 20px;
        width: 90%;
        max-width: 400px;
        text-align: center;
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }

    .modal h2 { font-family: 'Fredoka', sans-serif; color: var(--azul-primario); margin-top: 0; }

    input {
        width: 100%;
        padding: 12px;
        margin: 10px 0;
        border: 2px solid var(--azul-claro);
        border-radius: 10px;
        box-sizing: border-box;
        font-family: inherit;
    }

    .btn-save {
        background-color: var(--azul-primario);
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 10px;
        cursor: pointer;
        font-weight: bold;
        width: 100%;
        margin-top: 10px;
    }

    .btn-save:hover { background-color: #3498DB; }
    
    .btn-cancel {
        background: none;
        border: none;
        color: #888;
        margin-top: 15px;
        cursor: pointer;
        text-decoration: underline;
    }
</style>
</head>
<body>

<div class="folha-a4">
    <header>
        <h1>Gerenciador de Presentes üß∏</h1>
        <p>Clique em um pack para definir quem vai trazer</p>
    </header>

    <div id="gridPacks" class="lista-grid">
        </div>
</div>

<div id="modalOverlay" class="modal-overlay">
    <div class="modal">
        <h2 id="modalTitle">Pack #</h2>
        <input type="text" id="inputNome" placeholder="Nome da pessoa">
        <input type="text" id="inputTelefone" placeholder="Telefone">
        <button class="btn-save" onclick="salvarReserva()">Salvar Informa√ß√µes</button>
        <button class="btn-cancel" onclick="fecharModal()">Cancelar</button>
    </div>
</div>

<script>
// --- COLE O LINK DO GOOGLE ABAIXO ---
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxcljTc2SuJStoMqKVYCIqrCuszBHjXBiKD4gpki1OkpRJzmpesEtpNW_oQOuiqkNqx/exec";

const dataPacks = [];
// Gerando a estrutura dos 42 packs
for(let i=1; i<=6; i++) dataPacks.push({id: i, itens: ["Fralda P", "Len√ßos umedecidos", "Babador/Cotonete"]});
for(let i=7; i<=12; i++) dataPacks.push({id: i, itens: ["Fralda M", "Len√ßos umedecidos"]});
for(let i=13; i<=21; i++) dataPacks.push({id: i, itens: ["Fralda G", "Len√ßos umedecidos"]});
dataPacks.push({id: 22, itens: ["Kit Len√ßol ber√ßo", "Len√ßos umedecidos"]});
dataPacks.push({id: 23, itens: ["Kit Len√ßol ber√ßo", "Len√ßos umedecidos", "Algod√£o"]});
dataPacks.push({id: 24, itens: ["Kit Len√ßol ber√ßo", "Len√ßos umedecidos", "Algod√£o"]});
dataPacks.push({id: 25, itens: ["Term√¥metro digital", "Len√ßos umedecidos"]});
dataPacks.push({id: 26, itens: ["Aspirador nasal", "Len√ßos umedecidos"]});
for(let i=27; i<=30; i++) dataPacks.push({id: i, itens: ["Toalha com capuz"]});
for(let i=31; i<=33; i++) dataPacks.push({id: i, itens: ["Manta", "Babador"]});
dataPacks.push({id: 34, itens: ["Shampoo (Granado)"]});
dataPacks.push({id: 35, itens: ["Shampoo (Granado)"]});
dataPacks.push({id: 36, itens: ["Shampoo (Granado)", "Escova de cabelo"]});
dataPacks.push({id: 37, itens: ["Shampoo (Granado)", "Algod√£o"]});
for(let i=38; i<=41; i++) dataPacks.push({id: i, itens: ["Sabonete L√≠q. (Granado)", "Algod√£o"]});
dataPacks.push({id: 42, itens: ["Sabonete L√≠q. (Granado)", "Fralda de pano"]});

let packAtual = null;

// Fun√ß√£o para buscar dados da Planilha
async function carregarDadosDaPlanilha() {
    try {
        const response = await fetch(SCRIPT_URL);
        const data = await response.json();
        // data[0] s√£o os cabe√ßalhos, por isso come√ßamos do √≠ndice 1
        data.slice(1).forEach(linha => {
            const id = linha[0];
            const nome = linha[1];
            const tel = linha[2];
            if (nome) {
                const elemento = document.getElementById(`pack-${id}`);
                if (elemento) {
                    elemento.classList.add('reservado');
                    elemento.querySelector('.info-reserva').innerText = `‚úÖ Reservado por: ${nome}`;
                }
            }
        });
    } catch (error) {
        console.error("Erro ao carregar dados:", error);
    }
}

function renderizarPacks() {
    const grid = document.getElementById('gridPacks');
    grid.innerHTML = '';
    
    dataPacks.forEach(pack => {
        const div = document.createElement('div');
        div.id = `pack-${pack.id}`;
        div.className = `pack-item`;
        div.onclick = () => abrirModal(pack.id);
        
        let listaItens = pack.itens.map(item => `<div class="produto"><strong>${item}</strong></div>`).join('');
        
        div.innerHTML = `
            <div class="numero-circulo">${pack.id}</div>
            ${listaItens}
            <div class="info-reserva"></div>
        `;
        grid.appendChild(div);
    });
    carregarDadosDaPlanilha();
}

function abrirModal(id) {
    packAtual = id;
    document.getElementById('modalTitle').innerText = 'Pack #' + id;
    document.getElementById('modalOverlay').style.display = 'flex';
}

function fecharModal() {
    document.getElementById('modalOverlay').style.display = 'none';
}

async function salvarReserva() {
    const nome = document.getElementById('inputNome').value;
    const tel = document.getElementById('inputTelefone').value;
    const btn = document.querySelector('.btn-save');

    if(!nome) return alert("Digite o nome");

    btn.innerText = "Salvando...";
    btn.disabled = true;

    try {
        await fetch(SCRIPT_URL, {
            method: 'POST',
            body: JSON.stringify({ pack: packAtual, nome: nome, tel: tel })
        });
        fecharModal();
        location.reload(); // Recarrega para mostrar a nova reserva
    } catch (error) {
        alert("Erro ao salvar. Verifique sua conex√£o.");
        btn.innerText = "Salvar Informa√ß√µes";
        btn.disabled = false;
    }
}

renderizarPacks();
</script>

</body>
</html>
